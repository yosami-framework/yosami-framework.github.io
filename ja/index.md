---
layout: default
title: 'Yosami - Mithril.jsベースのSPA + SSRアプリケーション作成フレームワーク'
---

# Yosamiとは
Yosamiとは[Mithril](http://mithril-ja.js.org)をコアに使用した SPA + SSR アプリケーション作成のためのJavascriptフレームワークです。

Yosamiは追加実装なしにIE10以降のすべてのブラウザで動作します。

# 基本理念
Ruby on Rails に強く影響されたフレームワークであり、DRY原則とCoC原則でアプリケーションを構築できること、Railsに慣れ親しんだエンジニアが違和感なく使えるシステムであることが基本理念です。

# なぜYosamiなのか
世の中には素晴らしいフレームワークがいくつも存在します。その中でなぜYosamiなのか？Yosamiが持つ良さみを紹介します。

## 軽量・高速
[Mithril](http://mithril-ja.js.org)は軽量・高速なフレームワークです。

公表されているデータによると、Vue.jsを使用して同構成で作られたアプリに比べ「**150%程度高速**」で「**1/5程度のファイルサイズ**」です。その他にもMithrilの素晴らしさは語りきれないほどあるので、詳細は[Mithrilの公式ページ](http://mithril-ja.js.org)をご覧ください。

Yosamiはその素晴らしい[Mithril](http://mithril-ja.js.org)をコアに使用したフレームワークです。Mithrilの機能を十分に発揮できるように設計しているため、**Mithrilが持つメリットはYosamiでも受けることができます**。

軽量さはMithrilほどではないものの一般的なフレームワークよりも十分小さく、例えば[Nuxt.js](https://ja.nuxtjs.org/)は最小構成で53kb(min+gzip)ですが、**Yosamiは20kb(min+gzip)** です。

## ファイル分割制約
Yosamiにはコントローラやビューなど、役割ごとにファイルを分割してコードを実装します。

Railsに慣れ親しんだ方には普通のことに思えるかもしれません。しかし、Javascriptのフレームワークはすべてがそうではありません。

例えば、nuxt.jsでは `.vue` ファイルにビューもコントロールロジックも記述します。もちろん、自ら規約と設計を追加して分離することもできます。

しかし、Yosamiならはじめから分離されており、分離を前提に最適化をしています。

## 便利なジェネレータ
例えば、新しくページを追加したいとき「_コントローラーを定義して、ビューを追加して、スタイルファイルを作り、ルーティングを…_」と言ったロボットが行う作業はしなくても大丈夫です。

```shell
$ npm run generate controller
```

とコマンドを打つだけで、必要なものは全て揃い、テストファイルまで生成されます。

## SPA + SSRを手軽に実現
SPA + SSR を行うための実装はすべて含まれています。パッケージの追加や複雑な設定、コードの変更は必要ありません。

Yosamiのレールに沿ってコードを書き `npm start` コマンドを打つだけで、高度な技術に見えた SPA + SSR アプリケーションが動き出します。

## 大胆なキャッシュ戦略
サーバーサイドでは次の前提に基づき **大胆なキャッシュ戦略を行っています** 。

---

###### レンダリングされる内容
- ユーザごとに異なる内容はサーバーサイドでレンダリングしない

###### レンダリングされたデータが必要なシチュエーション

- アプリケーションの初回立ち上げ(ファーストビュー)
- 検索エンジンの巡回
- 外部サービスのページ展開 (twitterやfacebookなど)

---

どのシチュエーションでも、秒単位のリアルタイムデータを必要としていません。そこで、**Yosamiはレンダリング結果すべてオンメモリにLRUでキャッシュします**。

このため静的ファイル配信よりも早い応答が可能です。一例を上げると、静的ファイル配信のTTFBが平均1.5ms程度のローカル環境においては、TTFBは1ms以下でした。

## CSSの自動インライン化
ウェブアプリ開発で悩ましい問題の一つがCSSの読み込みです。

`<head>`セクションでCSSを読み込みを行うとページの読み込みがブロッキングされ、遅延ロードさせるとスタイルが適用されていないページが一瞬見えてしまうCSSフラッシュが発生します。

これは、UXを低下させる要因のひとつであり、UXを重視する検索エンジンではスコアに悪影響を及ぼす要因の一つです。

そこでYosamiでは、ページ内で使用されているセレクタを自動的に抽出し、サーバーサイドレンダリング時にインライン展開して埋め込みます。

この仕組みは[PageSpeed Insights](https://developers.google.com/speed/pagespeed/insights/?hl=ja)においてスコア100を狙える設計となっています。

----

いかがでしょうか？

この他にもYosamiは良さみを持っていますが、ぜひお試し頂き良さみを体感してください！！
